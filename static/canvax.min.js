'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},canvax={_imageCache:{},_isElement:function _isElement(a){try{return a instanceof HTMLElement}catch(b){return'object'===('undefined'==typeof a?'undefined':_typeof(a))&&a.hasOwnProperty('nodeType')}},_pointDistance:function _pointDistance(a,b){return Math.sqrt(Math.pow(Math.abs(a[0]-b[0]),2)+Math.pow(Math.abs(a[1]-b[1]),2))},_renderEntityToCanvas:function _renderEntityToCanvas(a,b){var c=a.ctx;switch(c.save(),b.type){case'Rectangle':'none'!==b.backgroundColor&&(c.fillStyle=b.backgroundColor,c.fillRect(b.x,b.y,b.width,b.height)),'0'!==b.borderWeight&&'none'!==b.borderColor&&(c.strokeStyle=b.borderColor,c.lineWidth=b.borderWeight,c.strokeRect(b.x,b.y,b.width,b.height));break;case'Circle':c.beginPath(),c.arc(b.x,b.y,b.radius,0,2*Math.PI,!1),'none'!==b.backgroundColor&&(c.fillStyle=b.backgroundColor,c.fill()),'0'!==b.borderWeight&&'none'!==b.borderColor&&(c.strokeStyle=b.borderColor,c.lineWidth=b.borderWeight,c.stroke());break;case'Ellipse':var d=.5522847493,e=b.width/2*d,f=b.height/2*d,g=b.x+b.width,h=b.y+b.height,j=b.x+b.width/2,k=b.y+b.height/2;c.beginPath(),c.moveTo(b.x,k),c.bezierCurveTo(b.x,k-f,j-e,b.y,j,b.y),c.bezierCurveTo(j+e,b.y,g,k-f,g,k),c.bezierCurveTo(g,k+f,j+e,h,j,h),c.bezierCurveTo(j-e,h,b.x,k+f,b.x,k),c.closePath(),'none'!==b.backgroundColor&&(c.fillStyle=b.backgroundColor,c.fill()),'0'!==b.borderWeight&&'none'!==b.borderColor&&(c.strokeStyle=b.borderColor,c.lineWidth=b.borderWeight,c.stroke());break;case'Image':if(c.rotate(b.rotation*Math.PI/180),canvax._imageCache.hasOwnProperty(b.source))var l=canvax._imageCache[b.source];else{var l=new Image;l.src=b.source,canvax._imageCache[b.source]=l}c.drawImage(l,b.x,b.y,b.width,b.height);break;case'Text':c.fillStyle=b.color,c.font=b.font,c.textAlign=b.alignment,c.fillText(b.text,b.x,b.y,b.maxWidth);break;case'CustomEntity':b.entityMethod(c,b.properties);break;default:}c.restore()},_renderEntitiesToCanvas:function _renderEntitiesToCanvas(a,b){for(var c=0;c<b.length;c++)canvax._renderEntityToCanvas(a,b[c])},_clearCanvas:function _clearCanvas(a,b){a.ctx.clearRect(0,0,b.width,b.height)},Renderer:function Renderer(a,b){var c=this;if(canvax._isElement(a)&&a.getContext)this.entities=[],this.element=a,this.ctx=a.getContext('2d'),this.add=function(d){c.entities.push(d)},this.clear=function(){c.entities=[]},this.render=function(){canvax._clearCanvas(c,c.element),canvax._renderEntitiesToCanvas(c,c.entities),c._fpsCount++},this._fpsCount=0,this.fps=0,b&&(this._autoRenderFrame=function(){c.render(),window.requestAnimationFrame(c._autoRenderFrame)},this._autoRenderFrame()),setInterval(function(){c.fps=5*c._fpsCount,c._fpsCount=0},200);else throw new Error('element is not a canvas element.')},Rectangle:function Rectangle(a,b,c,d,e,f,g){var h=this;if('undefined'!=typeof a&&'undefined'!=typeof b&&'undefined'!=typeof c&&'undefined'!=typeof d)this.type='Rectangle',this.x=a,this.y=b,this.width=c,this.height=d,this.backgroundColor=e||'none',this.borderColor=f||'#000000',this.borderWeight=g||'0px',this.setPosition=function(j,k){h.x=j,h.y=k},this.setSize=function(j,k){h.width=j,h.height=k},this.getBounds=function(){return{l:h.x-h.width/2,t:h.y+h.height/2,r:h.x+h.width/2,b:h.y-h.height/2}},this.intersects=function(j){if('Rectangle'===j.type||'Image'===j.type){var k=h.getBounds(),l=j.getBounds();return!(k.t<l.b||k.b>l.t||k.r<l.l||k.l>l.r)}if('Circle'===j.type){var m=j.x-Math.max(h.x,Math.min(j.x,h.x+h.width)),n=j.y-Math.max(h.y,Math.min(j.y,h.y+h.height));return Math.pow(m,2)+Math.pow(n,2)<Math.pow(j.radius,2)}};else throw new Error('Missing position parameter.')},Circle:function Circle(a,b,c,d,e,f){var g=this;if('undefined'!=typeof a&&'undefined'!=typeof b&&'undefined'!=typeof c)this.type='Circle',this.x=a,this.y=b,this.radius=c,this.backgroundColor=d||'none',this.borderColor=e||'#000000',this.borderWeight=f||'0px',this.setPosition=function(h,j){g.x=h,g.y=j},this.getBounds=function(){var h=g.radius/2;return{l:g.x-h,t:g.y+h,r:g.x+h,b:g.y-h}},this.intersects=function(h){if('Circle'===h.type)return canvax._pointDistance([g.x,g.y],[h.x,h.y])<g.radius+h.radius;if('Rectangle'===h.type||'Image'===h.type){var j=g.x-Math.max(h.x,Math.min(g.x,h.x+h.width)),k=g.y-Math.max(h.y,Math.min(g.y,h.y+h.height));return Math.pow(j,2)+Math.pow(k,2)<Math.pow(g.radius,2)}};else throw new Error('Missing position parameter.')},Ellipse:function Ellipse(a,b,c,d,e,f,g){var h=this;if('undefined'!=typeof a&&'undefined'!=typeof b&&'undefined'!=typeof c&&'undefined'!=typeof d)this.type='Ellipse',this.x=a,this.y=b,this.width=c,this.height=d,this.backgroundColor=e||'none',this.borderColor=f||'#000000',this.borderWeight=g||'0px',this.setPosition=function(j,k){h.x=j,h.y=k},this.setSize=function(j,k){h.width=j,h.height=k},this.getBounds=function(){return{l:h.x-h.width/2,t:h.y+h.height/2,r:h.x+h.width/2,b:h.y-h.height/2}};else throw new Error('Missing position parameter.')},Image:function Image(a,b,c,d,e,f){var g=this;if('undefined'!=typeof a&&'undefined'!=typeof b&&'undefined'!=typeof c&&'undefined'!=typeof d&&e)this.type='Image',this.x=a,this.y=b,this.width=c,this.height=d,this.source=e,this.rotation=f||0,this.setPosition=function(h,j){g.x=h,g.y=j},this.setSize=function(h,j){g.width=h,g.height=j},this.getBounds=function(){return{l:g.x,t:g.y,r:g.x+g.width,b:g.y-g.height}};else throw new Error('Missing required Image configuration parameter.')},Text:function Text(a,b,c,d,e,f,g){var h=this;if('undefined'!=typeof a&&'undefined'!=typeof b&&'undefined'!=typeof c)this.type='Text',this.x=a,this.y=b,'none'!==g&&(this.maxWidth=g),this.font=d||'30px Arial',this.text=c,this.alignment=f||'start',this.color=e||'#000000',this.setPosition=function(j,k){h.x=j,h.y=k};else throw new Error('Missing required Text configuration parameter.')},Entity:function Entity(a,b){if(a)this.type='CustomEntity',this.entityMethod=a,this.properties=b||{};else throw new Error('Missing entity method.')}};